---
type Variant = 'grid' | 'stack'

interface Props {
  href?: string
  variant?: Variant
  image?: string
  imageAlt?: string
  showImage?: boolean
  imageHeight?: string
  customClass?: string
  // További opcionális stílus osztályok
  wrapperClass?: string
  excerptClass?: string
  indicatorClass?: string
}

const {
  href,
  variant = 'grid',
  image,
  imageAlt = '',
  showImage = true,
  imageHeight,
  customClass = '',
  wrapperClass,
  excerptClass,
  indicatorClass,
} = Astro.props

const isStack = variant === 'stack'

// Alap stílusok a variant alapján
const baseClass =
  'bg-white rounded-lg overflow-hidden transition-shadow duration-300 h-full flex flex-col'
const variantClass = isStack
  ? 'border border-gray-200 shadow-sm group-hover:shadow-md'
  : 'shadow-md group-hover:shadow-lg'

// Kép magasság alapértelmezés
const defaultImageHeight = isStack ? 'h-28' : 'h-32 sm:h-40 md:h-48'
const finalImageHeight = imageHeight || defaultImageHeight

// Wrapper class (a link vagy article elemre)
const finalWrapperClass = wrapperClass || (isStack ? 'flex flex-col gap-4' : '')

// Ha van href, akkor link, különben div
const WrapperTag = href ? 'a' : 'div'
const computedWrapperClass = href
  ? `block group card-link ${finalWrapperClass}`
  : `card-link ${finalWrapperClass}`
const wrapperProps = href ? { href, class: computedWrapperClass } : { class: computedWrapperClass }
---

<WrapperTag {...wrapperProps}>
  <article class={`${baseClass} ${variantClass} ${customClass}`}>
    {
      showImage && image && (
        <div class={`relative ${finalImageHeight} overflow-hidden bg-gray-200`}>
          <img
            src={image}
            alt={imageAlt}
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
            loading="lazy"
          />
        </div>
      )
    }
    <div class="flex flex-grow flex-col p-6">
      <slot name="header" />
      <slot name="title" />
      <slot name="subtitle" />
      <slot name="description" />
      <slot />
      {indicatorClass && <div class={indicatorClass} />}
    </div>
  </article>
</WrapperTag>
